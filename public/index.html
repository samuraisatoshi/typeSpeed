<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TypeSpeed - Code Typing Practice</title>
  <link rel="stylesheet" href="css/styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="header">
      <div class="container">
        <h1 class="logo">TypeSpeed</h1>
        <nav class="nav">
          <button class="nav-btn" data-view="practice">Practice</button>
          <button class="nav-btn" data-view="stats">Statistics</button>
          <button class="nav-btn" data-view="settings">Settings</button>
        </nav>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main">
      <!-- Practice View -->
      <div id="practice-view" class="view active">
        <div class="container">
          <!-- Controls -->
          <div class="controls">
            <div class="control-group">
              <label for="folder-input">Project Folder:</label>
              <input type="text" id="folder-input" placeholder="/path/to/project" class="input">
              <button id="browse-btn" class="btn btn-secondary" title="Browse for folder">üìÅ</button>
              <button id="scan-btn" class="btn btn-primary">Scan Folder</button>
            </div>
            <div class="control-group">
              <label for="language-select">Language:</label>
              <select id="language-select" class="select">
                <option value="">All Languages</option>
              </select>
              <button id="start-btn" class="btn btn-success">Start Typing</button>
            </div>
          </div>

          <!-- Metrics Display -->
          <div class="metrics">
            <div class="metric">
              <span class="metric-label">WPM</span>
              <span id="wpm-display" class="metric-value">0</span>
            </div>
            <div class="metric">
              <span class="metric-label">Accuracy</span>
              <span id="accuracy-display" class="metric-value">100%</span>
            </div>
            <div class="metric">
              <span class="metric-label">Time</span>
              <span id="time-display" class="metric-value">0:00</span>
            </div>
            <div class="metric">
              <span class="metric-label">Progress</span>
              <span id="progress-display" class="metric-value">0%</span>
            </div>
          </div>

          <!-- Code Display with Direct Input -->
          <div id="code-container" class="code-container">
            <div id="code-display" class="code-display" tabindex="0">
              <p class="placeholder">Click "Scan Folder" to load code files, then "Start Typing" to begin</p>
            </div>
            <!-- Hidden input for capturing keyboard events -->
            <input
              type="text"
              id="hidden-input"
              class="hidden-input"
              autocomplete="off"
              autocorrect="off"
              autocapitalize="off"
              spellcheck="false"
              aria-hidden="true"
            />
          </div>

          <!-- Session Results Modal -->
          <div id="results-modal" class="modal">
            <div class="modal-content">
              <h2>Session Complete!</h2>
              <div id="results-content" class="results">
                <!-- Results will be populated here -->
              </div>
              <button id="close-results" class="btn btn-primary">Continue</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Statistics View -->
      <div id="stats-view" class="view">
        <div class="container">
          <h2>Your Statistics</h2>
          <div id="stats-container" class="stats-container">
            <div class="stats-grid">
              <div class="stat-card">
                <h3>Total Sessions</h3>
                <p id="total-sessions" class="stat-value">0</p>
              </div>
              <div class="stat-card">
                <h3>Average WPM</h3>
                <p id="avg-wpm" class="stat-value">0</p>
              </div>
              <div class="stat-card">
                <h3>Average Accuracy</h3>
                <p id="avg-accuracy" class="stat-value">0%</p>
              </div>
              <div class="stat-card">
                <h3>Practice Time</h3>
                <p id="practice-time" class="stat-value">0 min</p>
              </div>
              <div class="stat-card">
                <h3>Personal Best</h3>
                <p id="personal-best" class="stat-value">0 WPM</p>
              </div>
              <div class="stat-card">
                <h3>Favorite Language</h3>
                <p id="fav-language" class="stat-value">None</p>
              </div>
            </div>

            <div class="progress-chart">
              <h3>Progress Over Time</h3>
              <canvas id="progress-chart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Settings View -->
      <div id="settings-view" class="view">
        <div class="container">
          <h2>Settings</h2>
          <div class="settings-container">
            <div class="setting-group">
              <label for="theme-select">Theme:</label>
              <select id="theme-select" class="select">
                <option value="light">Light</option>
                <option value="dark">Dark</option>
                <option value="auto">Auto</option>
              </select>
            </div>
            <div class="setting-group">
              <label for="font-size">Font Size:</label>
              <input type="range" id="font-size" min="12" max="24" value="16" class="slider">
              <span id="font-size-value">16px</span>
            </div>
            <div class="setting-group">
              <label for="sound-enabled">Sound Effects:</label>
              <input type="checkbox" id="sound-enabled" class="checkbox">
            </div>
            <div class="setting-group">
              <label for="highlight-errors">Highlight Errors:</label>
              <input type="checkbox" id="highlight-errors" class="checkbox" checked>
            </div>
            <div class="setting-group">
              <label for="show-cursor">Show Cursor:</label>
              <input type="checkbox" id="show-cursor" class="checkbox" checked>
            </div>
            <div class="setting-group">
              <label for="max-lines">Max Lines Per Session:</label>
              <input type="range" id="max-lines" min="10" max="200" value="50" step="10" class="slider">
              <span id="max-lines-value">50 lines</span>
            </div>
            <div class="setting-group">
              <label for="snippet-length">Code Snippet Length:</label>
              <select id="snippet-length" class="select">
                <option value="short">Short (10-30 lines)</option>
                <option value="medium" selected>Medium (30-60 lines)</option>
                <option value="long">Long (60-100 lines)</option>
                <option value="very-long">Very Long (100-200 lines)</option>
              </select>
            </div>
            <button id="reset-stats" class="btn btn-danger">Reset Statistics</button>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <p>TypeSpeed - Practice typing with real code</p>
      </div>
    </footer>
  </div>

  <!-- Presentation Layer Scripts (DDD Architecture) -->
  <script src="js/presentation/ScrollPositionStrategy.js"></script>
  <script src="js/presentation/ViewportManager.js"></script>
  <script src="js/presentation/CodeDisplayPresenter.js"></script>
  <script src="js/presentation/FeedbackPresenter.js"></script>

  <!-- Infrastructure Layer Scripts (DDD Architecture) -->
  <script src="js/infrastructure/HttpClient.js"></script>

  <!-- Application Layer Scripts (DDD Architecture) -->
  <script src="js/application/SessionCompletionCoordinator.js"></script>

  <!-- Main Application -->
  <script src="js/app-direct-typing.js"></script>
</body>
</html>